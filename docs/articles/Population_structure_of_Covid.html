<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Population structure of SARS-Cov-2 • KLFDAPC</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Population structure of SARS-Cov-2">
<meta property="og:description" content="KLFDAPC">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-158177382-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-158177382-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">KLFDAPC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/xinghuq/KLFDAPC/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Population structure of SARS-Cov-2</h1>
                        <h4 class="author">Xinghu Qin</h4>
            
            <h4 class="date">27/10/2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/xinghuq/KLFDAPC/blob/master/vignettes/Population_structure_of_Covid.Rmd"><code>vignettes/Population_structure_of_Covid.Rmd</code></a></small>
      <div class="hidden name"><code>Population_structure_of_Covid.Rmd</code></div>

    </div>

    
    
<div id="using-klfdapc-to-infer-the-population-structue-of-sars-cov-2" class="section level2">
<h2 class="hasAnchor">
<a href="#using-klfdapc-to-infer-the-population-structue-of-sars-cov-2" class="anchor"></a>Using KLFDAPC to infer the population structue of SARS-Cov-2</h2>
<p>In this vignette, we demonstrate KLFDAPC for inference of the genetic structure of SARS-Cov-2. We used 3,736 SARS-Cov-2 samples obtained from China National Center for Bioinformation-2019 Novel Coronavirus Resource (2019nCoVR).</p>
<p>The data have been converted to gds file stored in the extdata folder in the package library. As long as you have installed the package, you can get the data using the codes listed below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/xinghuq/KLFDAPC">KLFDAPC</a></span><span class="op">)</span>

<span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>,package<span class="op">=</span><span class="st">'KLFDAPC'</span><span class="op">)</span>

<span class="va">infile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">f</span>, <span class="st">"2019-nCoV_total.gds"</span><span class="op">)</span></pre></div>
<p>We have ignored the sample origin in this vignette. If you are interested in the details of which countries are they smapled from, you can check the China National Center for Bioinformation-2019 Novel Coronavirus Resource (2019nCoVR) or check the raw data labels. However, here, in this analysis, we just demonstrate how to use KLFDAPC to infer the population structue. We generate random group labels for viruses.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">y1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,times<span class="op">=</span><span class="fl">1736</span><span class="op">)</span>
<span class="va">y2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>,times<span class="op">=</span><span class="fl">2000</span><span class="op">)</span>

<span class="va">y</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">y2</span><span class="op">)</span><span class="op">)</span>

<span class="va">y</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></pre></div>
</div>
<div id="klfdapc-analysis-with-a-gaussian-kernel" class="section level2">
<h2 class="hasAnchor">
<a href="#klfdapc-analysis-with-a-gaussian-kernel" class="anchor"></a>KLFDAPC Analysis with a Gaussian kernel</h2>
<p>We use a Gaussian kernel with a sigma = 5 to do the analysis. We filter the SNPs with a missing rate of 0.05, and MAF&gt;0.05, and keep 20 PCs for kernel local discriminant analysis. We then produce the first three genetic features for visualizing the population structure.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># Using Gaussian kernel</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co"># This will take longer than PCA, denpending on the number of samples and n.pcs. We will not show the results here. Users can test on their own clusters</span></a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6">virus_klfdapc=<span class="kw">KLFDAPC</span>(infile,y,<span class="dt">kernel=</span>kernlab<span class="op">::</span><span class="kw">rbfdot</span>(<span class="dt">sigma =</span> <span class="dv">5</span>),<span class="dt">r=</span><span class="dv">3</span>,<span class="dt">snp.id=</span><span class="ot">NULL</span>, <span class="dt">maf=</span><span class="fl">0.05</span>, <span class="dt">missing.rate=</span><span class="fl">0.05</span>,<span class="dt">n.pc=</span><span class="dv">20</span>,<span class="dt">tol=</span><span class="fl">1e-30</span>, <span class="dt">num.thread=</span><span class="dv">2</span>,<span class="dt">metric =</span> <span class="st">"plain"</span>,<span class="dt">prior =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co"># Warning: package 'klaR' was built under R version 3.6.3</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co"># observation 382</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co"># observation 399</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co"># observation 431</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co"># observation 628</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co"># observation 704</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co"># observation 735</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co"># observation 752</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co"># observation 803</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co"># observation 840</span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="co"># observation 884</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="co"># observation 889</span></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="co"># observation 890</span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="co"># observation 891</span></a>
<a class="sourceLine" id="cb3-34" title="34"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="co"># observation 899</span></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="co"># observation 919</span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-39" title="39"><span class="co"># observation 936</span></a>
<a class="sourceLine" id="cb3-40" title="40"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-41" title="41"><span class="co"># observation 941</span></a>
<a class="sourceLine" id="cb3-42" title="42"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-43" title="43"><span class="co"># observation 944</span></a>
<a class="sourceLine" id="cb3-44" title="44"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-45" title="45"><span class="co"># observation 949</span></a>
<a class="sourceLine" id="cb3-46" title="46"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-47" title="47"><span class="co"># observation 963</span></a>
<a class="sourceLine" id="cb3-48" title="48"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-49" title="49"><span class="co"># observation 1097</span></a>
<a class="sourceLine" id="cb3-50" title="50"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-51" title="51"><span class="co"># observation 1115</span></a>
<a class="sourceLine" id="cb3-52" title="52"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-53" title="53"><span class="co"># observation 1275</span></a>
<a class="sourceLine" id="cb3-54" title="54"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-55" title="55"><span class="co"># observation 1289</span></a>
<a class="sourceLine" id="cb3-56" title="56"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-57" title="57"><span class="co"># observation 1294</span></a>
<a class="sourceLine" id="cb3-58" title="58"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-59" title="59"><span class="co"># observation 1303</span></a>
<a class="sourceLine" id="cb3-60" title="60"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-61" title="61"><span class="co"># observation 1304</span></a>
<a class="sourceLine" id="cb3-62" title="62"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-63" title="63"><span class="co"># observation 1306</span></a>
<a class="sourceLine" id="cb3-64" title="64"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-65" title="65"><span class="co"># observation 1327</span></a>
<a class="sourceLine" id="cb3-66" title="66"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-67" title="67"><span class="co"># observation 1336</span></a>
<a class="sourceLine" id="cb3-68" title="68"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-69" title="69"><span class="co"># observation 1359</span></a>
<a class="sourceLine" id="cb3-70" title="70"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-71" title="71"><span class="co"># observation 1360</span></a>
<a class="sourceLine" id="cb3-72" title="72"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-73" title="73"><span class="co"># observation 1475</span></a>
<a class="sourceLine" id="cb3-74" title="74"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-75" title="75"><span class="co"># observation 1536</span></a>
<a class="sourceLine" id="cb3-76" title="76"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-77" title="77"><span class="co"># observation 1751</span></a>
<a class="sourceLine" id="cb3-78" title="78"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-79" title="79"><span class="co"># observation 2289</span></a>
<a class="sourceLine" id="cb3-80" title="80"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-81" title="81"><span class="co"># observation 2298</span></a>
<a class="sourceLine" id="cb3-82" title="82"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-83" title="83"><span class="co"># observation 2407</span></a>
<a class="sourceLine" id="cb3-84" title="84"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-85" title="85"><span class="co"># observation 2443</span></a>
<a class="sourceLine" id="cb3-86" title="86"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-87" title="87"><span class="co"># observation 2622</span></a>
<a class="sourceLine" id="cb3-88" title="88"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-89" title="89"><span class="co"># observation 2623</span></a>
<a class="sourceLine" id="cb3-90" title="90"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-91" title="91"><span class="co"># observation 2624</span></a>
<a class="sourceLine" id="cb3-92" title="92"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-93" title="93"><span class="co"># observation 2625</span></a>
<a class="sourceLine" id="cb3-94" title="94"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-95" title="95"><span class="co"># observation 2626</span></a>
<a class="sourceLine" id="cb3-96" title="96"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-97" title="97"><span class="co"># observation 2631</span></a>
<a class="sourceLine" id="cb3-98" title="98"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-99" title="99"><span class="co"># observation 3223</span></a>
<a class="sourceLine" id="cb3-100" title="100"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-101" title="101"><span class="co"># observation 3270</span></a>
<a class="sourceLine" id="cb3-102" title="102"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-103" title="103"><span class="co"># observation 3335</span></a>
<a class="sourceLine" id="cb3-104" title="104"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-105" title="105"><span class="co"># observation 3336</span></a>
<a class="sourceLine" id="cb3-106" title="106"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-107" title="107"><span class="co"># observation 3360</span></a>
<a class="sourceLine" id="cb3-108" title="108"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-109" title="109"><span class="co"># observation 3364</span></a>
<a class="sourceLine" id="cb3-110" title="110"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-111" title="111"><span class="co"># observation 3369</span></a>
<a class="sourceLine" id="cb3-112" title="112"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-113" title="113"><span class="co"># observation 3376</span></a>
<a class="sourceLine" id="cb3-114" title="114"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-115" title="115"><span class="co"># observation 3377</span></a>
<a class="sourceLine" id="cb3-116" title="116"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-117" title="117"><span class="co"># observation 3387</span></a>
<a class="sourceLine" id="cb3-118" title="118"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-119" title="119"><span class="co"># observation 3395</span></a>
<a class="sourceLine" id="cb3-120" title="120"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-121" title="121"><span class="co"># observation 3403</span></a>
<a class="sourceLine" id="cb3-122" title="122"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-123" title="123"><span class="co"># observation 3447</span></a>
<a class="sourceLine" id="cb3-124" title="124"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-125" title="125"><span class="co"># observation 3457</span></a>
<a class="sourceLine" id="cb3-126" title="126"><span class="co"># Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span></a>
<a class="sourceLine" id="cb3-127" title="127"><span class="co"># observation 3596</span></a>
<a class="sourceLine" id="cb3-128" title="128"></a>
<a class="sourceLine" id="cb3-129" title="129"><span class="kw">showfile.gds</span>(<span class="dt">closeall=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-130" title="130"><span class="co"># Principal Component Analysis (PCA) on genotypes:</span></a>
<a class="sourceLine" id="cb3-131" title="131"><span class="co"># Excluding 0 SNP on non-autosomes</span></a>
<a class="sourceLine" id="cb3-132" title="132"><span class="co"># Excluding 153 SNPs (monomorphic: TRUE, MAF: 0.05, missing rate: 0.05)</span></a>
<a class="sourceLine" id="cb3-133" title="133"><span class="co"># Working space: 3,736 samples, 3,065 SNPs</span></a>
<a class="sourceLine" id="cb3-134" title="134"><span class="co">#     using 2 (CPU) cores</span></a>
<a class="sourceLine" id="cb3-135" title="135"><span class="co"># PCA:    the sum of all selected genotypes (0,1,2) = 11420248</span></a>
<a class="sourceLine" id="cb3-136" title="136"><span class="co"># CPU capabilities: Double-Precision SSE2</span></a>
<a class="sourceLine" id="cb3-137" title="137"><span class="co"># Thu Oct 29 00:40:58 2020    (internal increment: 92)</span></a>
<a class="sourceLine" id="cb3-138" title="138"><span class="co"># </span></a>
<a class="sourceLine" id="cb3-139" title="139">[..................................................]  <span class="dv">0</span>%, ETC<span class="op">:</span><span class="st"> </span><span class="op">---</span><span class="st">        </span></a>
<a class="sourceLine" id="cb3-140" title="140">[<span class="op">==</span><span class="er">================================================</span>] <span class="dv">100</span>%, completed, 6s</a>
<a class="sourceLine" id="cb3-141" title="141"><span class="co"># Thu Oct 29 00:41:04 2020    Begin (eigenvalues and eigenvectors)</span></a>
<a class="sourceLine" id="cb3-142" title="142"><span class="co"># Thu Oct 29 00:41:29 2020    Done.</span></a>
<a class="sourceLine" id="cb3-143" title="143"><span class="co"># [1] "Doing KLFDAPC"</span></a></code></pre></div>
<div id="plot-the-population-structure-of-sars-cov-2" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-the-population-structure-of-sars-cov-2" class="anchor"></a>Plot the population structure of SARS-Cov-2</h3>
<div class="sourceCode" id="cb4"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">virus_klfdapc</span><span class="op">$</span><span class="va">KLFDAPC</span><span class="op">$</span><span class="va">Z</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">virus_klfdapc</span><span class="op">$</span><span class="va">KLFDAPC</span><span class="op">$</span><span class="va">Z</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"KLFDA 2"</span>, ylab<span class="op">=</span><span class="st">"KLFDA 1"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, pch<span class="op">=</span><span class="st">"o"</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html">nlevels</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<img src="Population_structure_of_Covid_files/figure-html/figure%201-1.png" alt="&amp;nbsp;" width="768"><p class="caption">
 
</p>
</div>
</div>
<div id="references" class="section level3">
<h3 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h3>
<p>Zhao WM, Song SH, Chen ML, et al. The 2019 novel coronavirus resource. Yi Chuan. 2020;42(2):212–221. <a href="doi:10.16288/j.yczz.20-030" class="uri">doi:10.16288/j.yczz.20-030</a> [PMID: 32102777]</p>
<p>Qin, X. 2020. KLFDAPC: Kernel Local Fisher Discriminant Analysis of Principal Components (KLFDAPC) for large genomic data. R package version 0.2.0.</p>
<p>Qin, X., Chiang, C.W.K., and Gaggiotti, O.E. (2021). Kernel Local Fisher Discriminant Analysis of Principal Components (KLFDAPC) significantly improves the accuracy of predicting geographic origin of individuals. <a href="https://www.biorxiv.org/content/10.1101/2021.05.15.444294v2.full" class="uri">bioRxiv</a>, 2021.2005.2015.444294.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Xinghu Qin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
