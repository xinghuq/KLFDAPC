<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Kernel local Fisher discriminant analysis of principal components (KLFDAPC)
 — KLFDAPC • KLFDAPC</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Kernel local Fisher discriminant analysis of principal components (KLFDAPC)
 — KLFDAPC" />
<meta property="og:description" content="This function performs Kernel local Fisher discriminant analysis of principal components (KLFDAPC) for genomic data
" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-158177382-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-158177382-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">KLFDAPC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/xinghuq/KLFDAPC/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Kernel local Fisher discriminant analysis of principal components (KLFDAPC)
<!-- %%  ~~function to do ... ~~ --></h1>
    
    <div class="hidden name"><code>KLFDAPC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs Kernel local Fisher discriminant analysis of principal components (KLFDAPC) for genomic data
<!-- %%  ~~ A concise (1-5 lines) description of what the function does. ~~ --></p>
    </div>

    <pre class="usage"><span class='fu'>KLFDAPC</span><span class='op'>(</span><span class='va'>infile</span>, <span class='va'>y</span>, <span class='va'>n.pc</span>,sample.id<span class='op'>=</span><span class='cn'>NULL</span>, snp.id<span class='op'>=</span><span class='cn'>NULL</span>,
                 autosome.only<span class='op'>=</span><span class='cn'>TRUE</span>, remove.monosnp<span class='op'>=</span><span class='cn'>TRUE</span>, maf<span class='op'>=</span><span class='cn'>NaN</span>, missing.rate<span class='op'>=</span><span class='cn'>NaN</span>,
                 algorithm<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"exact"</span>, <span class='st'>"randomized"</span><span class='op'>)</span>,
                 eigen.cnt<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span><span class='op'>(</span><span class='va'>algorithm</span>, <span class='st'>"randomized"</span><span class='op'>)</span>, <span class='fl'>16L</span>, <span class='fl'>32L</span><span class='op'>)</span>,
                 num.thread<span class='op'>=</span><span class='fl'>1L</span>, bayesian<span class='op'>=</span><span class='cn'>FALSE</span>, need.genmat<span class='op'>=</span><span class='cn'>FALSE</span>,
                 genmat.only<span class='op'>=</span><span class='cn'>FALSE</span>, eigen.method<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"DSPEVX"</span>, <span class='st'>"DSPEV"</span><span class='op'>)</span>,
                 aux.dim<span class='op'>=</span><span class='va'>eigen.cnt</span><span class='op'>*</span><span class='fl'>2L</span>, iter.num<span class='op'>=</span><span class='fl'>10L</span>, verbose<span class='op'>=</span><span class='cn'>TRUE</span>,
                 kernel<span class='op'>=</span><span class='fu'>kernlab</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/kernlab/man/dots.html'>polydot</a></span><span class='op'>(</span>degree <span class='op'>=</span> <span class='fl'>1</span>, scale <span class='op'>=</span> <span class='fl'>1</span>, offset <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>, r<span class='op'>=</span><span class='fl'>3</span>,
                 tol<span class='op'>=</span><span class='fl'>1e-30</span>,prior<span class='op'>=</span><span class='cn'>NULL</span>, CV<span class='op'>=</span><span class='cn'>FALSE</span>,usekernel <span class='op'>=</span> <span class='cn'>TRUE</span>,
                 fL <span class='op'>=</span> <span class='fl'>0.5</span>,metric <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'weighted'</span>, <span class='st'>'orthonormalized'</span>, <span class='st'>'plain'</span><span class='op'>)</span>,
                 knn <span class='op'>=</span> <span class='fl'>6</span>, reg <span class='op'>=</span> <span class='fl'>0.001</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>genofile</th>
      <td><p>The genomic files. This package uses GDS file to perform a high performance computation. GDS formatted data is designed for efficient random access to large data sets.The GDS file can be converted from various formats such as PLINK data format (BED) and vcf files via SNPRelate package.
<!-- %%     ~~Describe \code{genofile} here~~ --></p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>The group labels
<!-- %%     ~~Describe \code{y} here~~ --></p></td>
    </tr>
    <tr>
      <th>n.pc</th>
      <td><p>Number of PCs to proceed the KLFDA.
<!-- %%     ~~Describe \code{n.pc} here~~ --></p></td>
    </tr>
    <tr>
      <th>snp.id</th>
      <td><p>The sample IDs that the users want to select to perform the analysis, if NULL or missing, the default is to use all samples.
<!-- %%     ~~Describe \code{snp.id} here~~ --></p></td>
    </tr>
    <tr>
      <th>num.thread</th>
      <td><p>the number of (CPU) cores used; if NA, detect the number of cores automatically
<!-- %%     ~~Describe \code{num.thread} here~~ --></p></td>
    </tr>
    <tr>
      <th>kernel</th>
      <td><p>The kernel techniques used in KLFDA
<!-- %%     ~~Describe \code{kernel} here~~ --></p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>The number of reduced features
<!-- %%     ~~Describe \code{r} here~~ --></p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>The tolerance to decide if a matrix is singular; it will reject variables and linear combinations of unit-variance variables whose variance is less than tol^2.
<!-- %%     ~~Describe \code{tol} here~~ --></p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>The prior of the groups
<!-- %%     ~~Describe \code{prior} here~~ --></p></td>
    </tr>
    <tr>
      <th>CV</th>
      <td><p>If true, returns results (classes and posterior probabilities) for leave-one-out cross-validation. Note that if the prior is estimated, the proportions in the whole dataset are used.
<!-- %%     ~~Describe \code{CV} here~~ --></p></td>
    </tr>
    <tr>
      <th>usekernel</th>
      <td><p>Whether to use kernel classifier.whether to use kernel classifier, if TRUE, pass to Naive Bayes classifier.
<!-- %%     ~~Describe \code{usekernel} here~~ --></p></td>
    </tr>
    <tr>
      <th>fL</th>
      <td><p>If usekernel is TRUE, pass to the kernel function. See the kernel function from kernlab.
<!-- %%     ~~Describe \code{fL} here~~ --></p></td>
    </tr>
    <tr>
      <th>metric</th>
      <td><p>The type of metric in the embedding space (default: 'weighted') 'weighted' - weighted eigenvectors 'orthonormalized' - orthonormalized 'plain' - raw eigenvectors
<!-- %%     ~~Describe \code{metric} here~~ --></p></td>
    </tr>
    <tr>
      <th>knn</th>
      <td><p>The number of nearest neighbours
<!-- %%     ~~Describe \code{knn} here~~ --></p></td>
    </tr>
    <tr>
      <th>reg</th>
      <td><p>The regularization parameter
<!-- %%     ~~Describe \code{reg} here~~ --></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other parameters pass to klfda and snpgdsPCA.
<!-- %%     ~~Describe \code{\dots} here~~ --></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The kernel local discriminant analysis becomes complex once  the kernel tricks are intruduced into the function. We also employ the kernel classifier to make inference based on the non-linear features.
<!-- %%  ~~ If necessary, more details than the description above ~~ --></p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The results return two parts, the results of PCA and the results of KLFDAPC including the classified classes and the posterior possibility of each class using different classifier.
<!-- %%  ~Describe the value returned -->
<!-- %%  If it is a LIST, use --></p>
<dt>KLFDAPC</dt><dd><p>The results of KLFDAPC including the classified classes and the posterior possibility of each class using different classifier</p></dd>
<dt>PCA</dt><dd><p>PCA results</p></dd>
%% ...

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    

<p>Sugiyama, M (2007).Dimensionality reduction of multimodal labeled data by local Fisher discriminant analysis. Journal of Machine Learning Research, vol.8, 1027-1061.</p>
<p>Sugiyama, M (2006). Local Fisher discriminant analysis for supervised dimensionality reduction. In W. W. Cohen and A. Moore (Eds.), Proceedings of 23rd International Conference on Machine Learning (ICML2006), 905-912.</p>
<p>Original Matlab Implementation: http://www.ms.k.u-tokyo.ac.jp/software.html#LFDA</p>
<p>Tang, Y., &amp; Li, W. (2019). lfda: Local Fisher Discriminant Analysis inR. Journal of Open Source Software, 4(39), 1572.</p>
<p>Moore, A. W. (2004). Naive Bayes Classifiers. In School of Computer Science. Carnegie Mellon University.</p>
<p>Pierre Enel (2020). Kernel Fisher Discriminant Analysis (https://www.github.com/p-enel/MatlabKFDA), GitHub. Retrieved March 30, 2020.</p>
<p>Karatzoglou, A., Smola, A., Hornik, K., &amp; Zeileis, A. (2004). kernlab-an S4 package for kernel methods in R. Journal of statistical software, 11(9), 1-20.</p>
<p>Zheng, X., Levine, D., Shen, J., Gogarten, S. M., Laurie, C., &amp; Weir, B. S. (2012). A high-performance computing toolset for relatedness and principal component analysis of SNP data. Bioinformatics, 28(24), 3326-3328.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>qinxinghu@gmail.com
<!-- %%  ~~who you are~~ --></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>### input file</span>
<span class='va'>f</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>'extdata'</span>,package<span class='op'>=</span><span class='st'>'KLFDAPC'</span><span class='op'>)</span>
<span class='va'>infile</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>f</span>, <span class='st'>"2019-nCoV_total.gds"</span><span class='op'>)</span>
<span class='co'>##Note the labels below is random</span>
<span class='va'>y1</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,times<span class='op'>=</span><span class='fl'>1736</span><span class='op'>)</span>
<span class='va'>y2</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>2</span>,times<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span>
<span class='va'>y</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>y1</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>y2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>y</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
<span class='co'>### using gaussan kernel</span>
<span class='co'>### This will take longer than PCA, denpending on the number of samples and n.pcs.</span>
<span class='co'>#We will not show the results here. Users can test on their own clusters</span>
<span class='co'>###virus_klfdapc=KLFDAPC(infile,y,kernel=kernlab::rbfdot(sigma = 0.5),r=3,snp.id=NULL, maf=0.05, missing.rate=0.05,n.pc=10,tol=1e-30, num.thread=2,metric = "plain",prior = NULL)</span>
<span class='co'>#showfile.gds(closeall=TRUE)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Xinghu Qin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


